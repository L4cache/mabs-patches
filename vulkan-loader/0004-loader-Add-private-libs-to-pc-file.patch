From aadc0d1d5252305c2144161f15c514972cb8f807 Mon Sep 17 00:00:00 2001
From: Christopher Degawa <ccom@randomderp.com>
Date: Mon, 2 Oct 2023 01:35:10 -0500
Subject: [PATCH 4/5] loader: Add private libs to pc file

Signed-off-by: Christopher Degawa <ccom@randomderp.com>
---
 loader/CMakeLists.txt | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/loader/CMakeLists.txt b/loader/CMakeLists.txt
index f942c239c..f32e68193 100644
--- a/loader/CMakeLists.txt
+++ b/loader/CMakeLists.txt
@@ -420,6 +420,16 @@ endif()
 find_package(PkgConfig QUIET)
 if(PKG_CONFIG_FOUND)
     set(PRIVATE_LIBS "")
+    get_target_property(vulkan_privates vulkan LINK_LIBRARIES) # get the list of private libraries
+    foreach(LIB IN LISTS vulkan_privates)
+        if (NOT LIB MATCHES "<") # Don't generator expressions
+            list(APPEND PRIVATE_LIBS "-l${LIB}")
+        endif()
+    endforeach()
+    list(REMOVE_DUPLICATES PRIVATE_LIBS)
+    string(REPLACE ";" " " PRIVATE_LIBS "${PRIVATE_LIBS}")
+    set(PRIVATE_LIBS "Libs.private: ${PRIVATE_LIBS}")
+
     if(WIN32)
         if(MINGW)
             set(VULKAN_LIB_SUFFIX "-1.dll")
-- 
2.41.0

